<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>مهمة جمع الأدلة — النسخة الملكية v9</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<style>
:root { --gold:#FFD54A; --ink:#0b1226; --red:#ff2a2a; --green:#00e676; }
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html,body { height:100%; margin:0; font-family:"Cairo",system-ui,Segoe UI,Roboto,Arial; background:#000; color:var(--gold); overflow:hidden; }

/* ===== Loader (black+gold) ===== */
#loader {
  position:fixed; inset:0; background:#000; z-index:3000;
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:16px;
}
.loader-title { font-weight:900; letter-spacing:.4px; font-size:clamp(1rem,3.2vw,1.4rem); color:var(--gold) }
.progress { width:min(72vw,520px); height:10px; border-radius:999px; border:1px solid rgba(255,213,74,.7); overflow:hidden;
  box-shadow:0 0 26px rgba(255,213,74,.25), inset 0 0 10px rgba(255,213,74,.2); }
.progress i { display:block; height:100%; width:0%;
  background:linear-gradient(90deg, rgba(255,213,74,.2), rgba(255,213,74,.9) 60%, rgba(255,213,74,.2)); transition:width .25s ease;
  filter: drop-shadow(0 0 16px rgba(255,213,74,.55)); }

/* ===== Intro screen ===== */
#intro {
  position:fixed; inset:0; background:#000; z-index:2000;
  display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:24px;
  opacity:0; pointer-events:none; transition: opacity .8s ease;
}
#intro.show { opacity:1; pointer-events:auto; }
.intro-text { max-width:900px; line-height:1.9; font-size:clamp(1rem,2.6vw,1.5rem); font-weight:800; text-shadow:0 0 16px rgba(255,213,74,.35); color:var(--gold) }
#startBtn {
  margin-top:22px; padding:14px 26px; border:none; border-radius:14px; font-weight:900; letter-spacing:.4px;
  background:var(--gold); color:#101625; cursor:pointer; box-shadow:0 0 26px rgba(255,213,74,.45), inset 0 0 10px rgba(255,255,255,.3);
  opacity:0; pointer-events:none; transform:scale(.98); transition: opacity .6s ease, transform .3s ease;
}
#startBtn.show { opacity:1; pointer-events:auto; transform:scale(1); animation:pulse 2.2s ease-in-out infinite; }
@keyframes pulse { 0%,100%{box-shadow:0 0 26px rgba(255,213,74,.45)} 50%{box-shadow:0 0 44px rgba(255,213,74,.7)} }

/* ===== Scene (fullscreen) ===== */
#scene {
  position:fixed; inset:0; z-index:100; display:none; opacity:0; transition:opacity .7s ease;
}
#scene.show { display:block; }
#scene.visible { opacity:1; }
.scene-wrap { position:absolute; inset:0; }
.scene-wrap img {
  position:absolute; inset:0; width:100%; height:100%; object-fit:cover; /* فول سكرين بدون قص ثابت */
}

/* SVG overlay (for hidden polygon areas) */
#overlay {
  position:absolute; inset:0; width:100%; height:100%; pointer-events:auto; z-index:120;
}

/* Tooltip (when revealing after correct click) */
.tooltip {
  position:absolute; padding:8px 10px; border-radius:10px; font-weight:800; color:#101625;
  background:linear-gradient(165deg, rgba(255,245,200,.98), rgba(255,230,160,.98));
  border:1px solid rgba(255,215,0,.75); box-shadow:0 16px 40px rgba(0,0,0,.35);
  display:none; z-index:121; white-space:nowrap;
}

/* Topbar (timer) */
#topbar {
  position:fixed; top:12px; left:50%; transform:translateX(-50%); width:min(1100px,96vw);
  display:flex; justify-content:flex-end; z-index:130; opacity:0; transition:opacity .5s ease;
}
#topbar.show { opacity:1; }
.timer { background:rgba(0,0,0,.35); border:1px solid rgba(255,215,0,.35); border-radius:12px; padding:8px 12px; font-weight:800; }
.timer.warning { color:#fff; border-color:rgba(255,60,60,.7); box-shadow:0 0 16px rgba(255,60,60,.35); }

/* Toast + End modal */
#toast {
  position:fixed; bottom:18px; left:50%; transform:translateX(-50%);
  background:rgba(0,0,0,.75); color:#fff; padding:10px 14px; border-radius:10px; display:none; z-index:140;
}
#end {
  position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:200;
}
.end-card {
  background:#fff; color:#111; border-radius:14px; padding:20px 24px; text-align:center; max-width:560px;
  box-shadow:0 28px 80px rgba(0,0,0,.45);
}
.actions { margin-top:14px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
.actions a {
  text-decoration:none; padding:10px 16px; border-radius:10px; font-weight:800; cursor:pointer;
  background:linear-gradient(145deg,#0d1a35,#000814); color:#FFD54A; border:1px solid rgba(255,215,0,.45);
}
.actions a.secondary { background:#FFD54A; color:#0d1a35; border-color:#FFD54A; }
.fade-hide { opacity:0 !important; pointer-events:none !important; }
/* إبقاء الدليل الظاهر بعد العثور عليه */
.hotspot.found {
  background: radial-gradient(circle, var(--green) 0%, #005500 80%);
  box-shadow: 0 0 14px rgba(0,255,100,.8);
  opacity: 1 !important;
  pointer-events: none; /* حتى لا يتم الضغط عليه مرة أخرى */
}

/* small accessible focus */
a:focus, button:focus { outline:2px solid rgba(255,215,74,.25); outline-offset:3px; }
/* تحسين العرض على الشاشات الصغيرة جداً (مثل الجوالات أقل من 400px عرضاً) */
@media (max-width: 400px) {
  .intro-text {
    font-size: 0.9rem;
    line-height: 1.6;
    margin-bottom: 20px;
  }

  #startBtn {
    padding: 10px 18px;
    font-size: 0.9rem;
    margin-bottom: 40px; /* 🔹 إبعاد الزر عن الصورة */
  }

  .loader-title {
    font-size: 0.9rem;
  }

  .timer {
    font-size: 0.85rem;
  }

  /* 🔹 تقليل حجم الصورة وتحريكها للأسفل */
  #intro::after {
    bottom: 220px; /* كانت 170px، زدنا المسافة */
    width: 300px;
    height: 380px;
    opacity: 0.2;
  }
}


/* عند اكتشاف دليل، أضف علامة ✅ صغيرة فوقه */
.hotspot.found::after {
  content: "✅";
  position: absolute;
  top: -18px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 20px;
  color: var(--green);
  text-shadow: 0 0 10px rgba(0,255,0,.7);
}
#intro::after {
  content: "";
  position: absolute;
  right: 4%;
  bottom: 170px;
  width: 360px;
  height: 440px;
  background: url('https://cityupload.io/2025/10/saluting-soldier-silhouette-vector-isolated-on-white-background-military-man-in-parade-700-291560853.png') 
              no-repeat center bottom;
  background-size: contain;
  opacity: 0.25;
  filter: drop-shadow(0 0 30px rgba(255,213,74,0.35)) brightness(3);
  animation: fadeInSoldier 2.5s ease forwards;
}

@keyframes fadeInSoldier {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 0.25; transform: translateY(0); }
}


</style>
</head>
<body>

<!-- Loader -->
<div id="loader">
  <div class="loader-title">جاري تجهيز المشهد السينمائي...</div>
  <div class="progress"><i id="bar"></i></div>
</div>

<!-- Intro -->
<section id="intro">
  <div class="intro-text">
    عزيزي الطالب الضابط، بعد الانتهاء من معاينة مسرح الجريمة الثلاثي الأبعاد،
    الآن جاء الوقت لاختبارك بتحديد الأدلة الموجودة في مسرح الجريمة.
    اضغط ابدأ جمع الأدلة.
  </div>
  <button id="startBtn">ابدأ جمع الأدلة</button>
</section>

<!-- Scene -->
<section id="scene">
  <div class="scene-wrap" id="sceneWrap">
    <img id="bg" src="https://dns3uae-glitch.github.io/crime-book/assets/room2.jpg" alt="مشهد الجريمة">
    <!-- SVG overlay will host polygons (hidden) -->
    <svg id="overlay" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 100 100" aria-hidden="true"></svg>
    <div class="tooltip" id="tooltip"></div>
  </div>
  <div id="topbar"><div class="timer" id="timer">الوقت المتبقي: 01:00</div></div>
</section>

<!-- Toast -->
<div id="toast">لا يوجد دليل هنا، ابحث في مكان آخر.</div>

<!-- End Modal -->
<div id="end">
  <div class="end-card">
    <h2 id="endTitle">🎉 تم تحديد جميع الأدلة بنجاح</h2>
    <p id="endText">أحسنت يا ضابط، لقد حددت جميع الأدلة بنجاح!</p>
    <div class="actions">
      <a class="secondary" href="https://dns3uae-glitch.github.io/crime-book/3d/index.html">🔁 إعادة المهمة</a>
      <a href="https://dns3uae-glitch.github.io/crime-book/3d-2/index.html">⏭️ المرحلة التالية</a>
    </div>
  </div>
</div>

<script>
/*
  Implementation notes:
  - The new shapes data (fromك) are stored in `shapes`.
  - Each shape contains name and points [{x:..., y:...}] where x,y are percentages (0..100).
  - We render invisible polygons in the SVG overlay (viewBox 0..100 so percentages map directly).
  - On pointerdown in the scene we test point-in-polygon using percentages.
  - Threshold behavior: a click is considered "near enough" if point is inside polygon OR distance to polygon edges <= 2% of the smaller dimension (~approx 20px on typical screen).
  - When correct: speak the success phrase and show tooltip briefly; increment foundCount.
  - When all found: stop timer, speak final phrase, show end modal.
*/

/* ===== App elements ===== */
const loader = document.getElementById('loader');
const bar = document.getElementById('bar');
const intro = document.getElementById('intro');
const startBtn = document.getElementById('startBtn');
const scene = document.getElementById('scene');
const timerEl = document.getElementById('timer');
const toast = document.getElementById('toast');
const tooltip = document.getElementById('tooltip');
const bg = document.getElementById('bg');
const overlay = document.getElementById('overlay');
const endModal = document.getElementById('end');

let countdown = 60; // seconds
let timerHandle = null;
let foundCount = 0;

/* ===== Shapes data (from input) ===== */
const shapes = [
  {
    "name": "رسالة تهديد بفعل المزيد",
    "points": [ { "x":91.49,"y":17.34 },{ "x":91.2,"y":17.13 },{ "x":90.65,"y":17.02 },{ "x":90,"y":17.07 },{ "x":89.61,"y":17.07 },{ "x":89.35,"y":17.24 },{ "x":88.95,"y":17.34 },{ "x":88.61,"y":17.34 },{ "x":88.27,"y":17.34 },{ "x":87.88,"y":17.34 },{ "x":87.57,"y":17.34 },{ "x":87.2,"y":17.34 },{ "x":86.83,"y":17.34 },{ "x":86.47,"y":17.34 },{ "x":86.15,"y":17.34 },{ "x":85.79,"y":17.34 },{ "x":85.45,"y":17.34 },{ "x":85.13,"y":17.34 },{ "x":85.13,"y":17.72 },{ "x":85.13,"y":18.05 },{ "x":85.13,"y":18.43 },{ "x":85.13,"y":18.92 },{ "x":85.13,"y":19.46 },{ "x":85.13,"y":19.84 },{ "x":85.13,"y":20.16 },{ "x":85.16,"y":20.54 },{ "x":85.16,"y":20.87 },{ "x":85.16,"y":21.36 },{ "x":85.16,"y":21.73 },{ "x":85.21,"y":22.06 },{ "x":85.21,"y":22.44 },{ "x":85.21,"y":22.76 },{ "x":85.21,"y":23.14 },{ "x":85.21,"y":23.58 },{ "x":85.21,"y":24.01 },{ "x":85.21,"y":24.44 },{ "x":85.16,"y":24.99 },{ "x":85.13,"y":25.31 },{ "x":85.08,"y":25.69 },{ "x":85.05,"y":26.02 },{ "x":85,"y":26.34 },{ "x":84.92,"y":26.78 },{ "x":84.9,"y":27.1 },{ "x":84.87,"y":27.43 },{ "x":84.87,"y":27.8 },{ "x":84.82,"y":28.18 },{ "x":84.82,"y":28.62 },{ "x":84.82,"y":29.05 },{ "x":84.82,"y":29.54 },{ "x":84.82,"y":29.92 },{ "x":84.82,"y":30.3 },{ "x":84.74,"y":30.73 },{ "x":84.69,"y":31.17 },{ "x":84.55,"y":31.65 },{ "x":84.48,"y":31.98 },{ "x":84.45,"y":32.36 },{ "x":84.35,"y":32.79 },{ "x":84.29,"y":33.12 },{ "x":84.29,"y":33.44 },{ "x":84.29,"y":33.82 },{ "x":84.5,"y":34.04 },{ "x":84.84,"y":34.2 },{ "x":85.16,"y":34.36 },{ "x":85.47,"y":34.47 },{ "x":85.86,"y":34.63 },{ "x":86.18,"y":34.74 },{ "x":86.44,"y":34.91 },{ "x":86.78,"y":34.96 },{ "x":87.09,"y":34.96 },{ "x":87.43,"y":34.96 },{ "x":87.75,"y":34.96 },{ "x":88.06,"y":34.96 },{ "x":88.4,"y":34.96 },{ "x":88.82,"y":34.96 },{ "x":89.16,"y":35.07 },{ "x":89.5,"y":35.12 },{ "x":89.76,"y":35.28 },{ "x":90.16,"y":35.28 },{ "x":90.47,"y":35.39 },{ "x":90.73,"y":35.56 },{ "x":90.86,"y":35.01 },{ "x":90.89,"y":34.42 },{ "x":90.97,"y":34.09 },{ "x":91.02,"y":33.66 },{ "x":91.05,"y":33.12 },{ "x":91.05,"y":32.79 },{ "x":91.05,"y":32.41 },{ "x":91.05,"y":31.98 },{ "x":91.05,"y":31.65 },{ "x":91.1,"y":31.27 },{ "x":91.13,"y":30.84 },{ "x":91.18,"y":30.41 },{ "x":91.18,"y":30.08 },{ "x":91.18,"y":29.59 },{ "x":91.26,"y":29.05 },{ "x":91.28,"y":28.46 },{ "x":91.28,"y":28.02 },{ "x":91.34,"y":27.64 },{ "x":91.34,"y":27.32 },{ "x":91.34,"y":26.88 },{ "x":91.36,"y":26.29 },{ "x":91.36,"y":25.91 },{ "x":91.36,"y":25.58 },{ "x":91.41,"y":25.2 },{ "x":91.41,"y":24.72 },{ "x":91.41,"y":24.34 },{ "x":91.41,"y":23.85 },{ "x":91.41,"y":23.52 },{ "x":91.41,"y":22.93 },{ "x":91.41,"y":22.55 },{ "x":91.41,"y":22.22 },{ "x":91.41,"y":21.57 },{ "x":91.41,"y":21.25 },{ "x":91.47,"y":20.54 },{ "x":91.49,"y":20.16 },{ "x":91.49,"y":19.84 },{ "x":91.49,"y":19.51 },{ "x":91.54,"y":19.08 },{ "x":91.54,"y":18.75 },{ "x":91.57,"y":18.43 },{ "x":91.57,"y":18.05 },{ "x":91.57,"y":17.67 },{ "x":91.57,"y":17.29 },{ "x":91.62,"y":16.96 } ]
  },
  {
    "name": "بقعة دم قريبة من الجثة",
    "points": [ { "x":66.73,"y":65.04 },{ "x":66.73,"y":65.42 },{ "x":66.81,"y":66.07 },{ "x":66.86,"y":66.67 },{ "x":66.94,"y":67.1 },{ "x":66.94,"y":67.48 },{ "x":66.94,"y":67.8 },{ "x":66.94,"y":68.13 },{ "x":66.94,"y":68.51 },{ "x":66.94,"y":68.83 },{ "x":66.94,"y":69.27 },{ "x":66.94,"y":69.86 },{ "x":66.94,"y":70.3 },{ "x":66.94,"y":70.62 },{ "x":66.94,"y":70.95 },{ "x":66.99,"y":71.33 },{ "x":67.04,"y":71.71 },{ "x":66.78,"y":71.87 },{ "x":66.47,"y":71.87 },{ "x":66.05,"y":71.71 },{ "x":65.65,"y":71.6 },{ "x":65.29,"y":71.6 },{ "x":64.97,"y":71.6 },{ "x":64.61,"y":71.6 },{ "x":64.27,"y":71.6 },{ "x":63.98,"y":71.76 },{ "x":63.53,"y":71.76 },{ "x":63.22,"y":71.76 },{ "x":62.85,"y":71.71 },{ "x":62.62,"y":71.49 },{ "x":62.41,"y":71.27 },{ "x":62.17,"y":71.06 },{ "x":61.88,"y":70.79 },{ "x":61.65,"y":70.51 },{ "x":61.47,"y":70.24 },{ "x":61.31,"y":69.97 },{ "x":61.1,"y":69.7 },{ "x":60.86,"y":69.43 },{ "x":60.73,"y":69.16 },{ "x":60.58,"y":68.89 },{ "x":60.39,"y":68.56 },{ "x":60.24,"y":68.24 },{ "x":60.05,"y":67.97 },{ "x":59.82,"y":67.7 },{ "x":59.53,"y":67.59 },{ "x":59.27,"y":67.32 },{ "x":58.93,"y":67.15 },{ "x":58.66,"y":66.94 },{ "x":58.46,"y":66.72 },{ "x":58.22,"y":66.4 },{ "x":58.12,"y":66.02 },{ "x":58.12,"y":65.69 },{ "x":58.12,"y":65.26 },{ "x":58.12,"y":64.93 },{ "x":58.12,"y":64.61 },{ "x":58.19,"y":64.23 },{ "x":58.27,"y":63.9 },{ "x":58.53,"y":63.63 },{ "x":58.82,"y":63.52 },{ "x":59.19,"y":63.52 },{ "x":59.37,"y":63.79 },{ "x":59.63,"y":64.17 },{ "x":59.76,"y":64.44 },{ "x":60.03,"y":64.61 },{ "x":60.18,"y":64.88 },{ "x":60.52,"y":64.93 },{ "x":60.86,"y":64.93 },{ "x":61.2,"y":64.72 },{ "x":61.52,"y":64.55 },{ "x":61.83,"y":64.55 },{ "x":62.17,"y":64.55 },{ "x":62.49,"y":64.55 },{ "x":62.83,"y":64.55 },{ "x":63.22,"y":64.55 },{ "x":63.59,"y":64.55 },{ "x":63.93,"y":64.55 },{ "x":64.35,"y":64.55 },{ "x":64.71,"y":64.39 },{ "x":64.95,"y":64.17 },{ "x":65.29,"y":64.17 },{ "x":65.63,"y":64.17 },{ "x":66.02,"y":64.17 },{ "x":66.34,"y":64.17 },{ "x":66.49,"y":64.44 },{ "x":66.73,"y":64.66 },{ "x":66.83,"y":64.99 } ]
  },
  {
    "name": "بقعة دم على الأرض",
    "points": [ { "x":66.47,"y":57.02 },{ "x":66.78,"y":57.02 },{ "x":67.12,"y":57.29 },{ "x":67.23,"y":57.62 },{ "x":67.41,"y":57.89 },{ "x":67.41,"y":58.21 },{ "x":67.41,"y":58.54 },{ "x":67.28,"y":58.81 },{ "x":67.17,"y":59.13 },{ "x":66.94,"y":59.46 },{ "x":66.57,"y":59.51 },{ "x":66.15,"y":59.51 },{ "x":65.84,"y":59.51 },{ "x":65.5,"y":59.35 },{ "x":65.21,"y":59.24 },{ "x":64.87,"y":59.19 },{ "x":64.61,"y":59.02 },{ "x":64.35,"y":58.86 },{ "x":64.03,"y":58.64 },{ "x":63.77,"y":58.37 },{ "x":63.43,"y":58.32 },{ "x":63.09,"y":58.32 },{ "x":62.7,"y":58.32 },{ "x":62.38,"y":58.43 },{ "x":62.09,"y":58.59 },{ "x":61.86,"y":58.81 },{ "x":61.54,"y":58.81 },{ "x":61.23,"y":59.02 },{ "x":60.94,"y":59.13 },{ "x":60.71,"y":59.35 },{ "x":60.5,"y":59.57 },{ "x":60.34,"y":59.89 },{ "x":60.39,"y":60.22 },{ "x":60.47,"y":60.7 },{ "x":60.47,"y":61.08 },{ "x":60.47,"y":61.46 },{ "x":60.16,"y":61.52 },{ "x":59.82,"y":61.36 },{ "x":59.55,"y":61.19 },{ "x":59.27,"y":61.03 },{ "x":58.93,"y":60.81 },{ "x":58.66,"y":60.65 },{ "x":58.35,"y":60.54 },{ "x":57.88,"y":60.38 },{ "x":57.54,"y":60.38 },{ "x":57.15,"y":60.38 },{ "x":56.81,"y":60.38 },{ "x":56.41,"y":60.38 },{ "x":56.07,"y":60.27 },{ "x":55.76,"y":60.22 },{ "x":55.39,"y":60.22 },{ "x":55.05,"y":60.11 },{ "x":54.82,"y":59.89 },{ "x":54.48,"y":59.51 },{ "x":54.27,"y":59.24 },{ "x":54.03,"y":58.86 },{ "x":53.77,"y":58.54 },{ "x":53.53,"y":58.21 },{ "x":53.3,"y":57.94 },{ "x":53.06,"y":57.62 },{ "x":52.83,"y":57.29 },{ "x":52.7,"y":57.02 },{ "x":52.46,"y":56.75 },{ "x":52.33,"y":56.37 },{ "x":52.2,"y":56.1 },{ "x":52.02,"y":55.83 },{ "x":51.75,"y":55.66 },{ "x":51.41,"y":55.66 },{ "x":51.1,"y":55.56 },{ "x":50.97,"y":55.28 },{ "x":51.1,"y":55.01 },{ "x":51.26,"y":54.63 },{ "x":51.6,"y":54.42 },{ "x":51.91,"y":54.25 },{ "x":52.33,"y":54.2 },{ "x":52.67,"y":54.04 },{ "x":53.01,"y":53.88 },{ "x":53.35,"y":53.88 },{ "x":53.72,"y":53.88 },{ "x":54.03,"y":53.77 },{ "x":54.42,"y":53.77 },{ "x":54.79,"y":53.71 },{ "x":55.13,"y":53.71 },{ "x":55.47,"y":53.6 },{ "x":55.84,"y":53.6 },{ "x":56.15,"y":53.6 },{ "x":56.6,"y":53.66 },{ "x":56.94,"y":53.71 },{ "x":57.25,"y":53.71 },{ "x":57.62,"y":53.71 },{ "x":57.98,"y":53.71 },{ "x":58.3,"y":53.71 },{ "x":58.61,"y":53.71 },{ "x":58.93,"y":53.77 },{ "x":59.19,"y":53.44 },{ "x":59.63,"y":53.12 },{ "x":59.92,"y":52.9 },{ "x":60.26,"y":52.9 },{ "x":60.63,"y":52.9 },{ "x":60.99,"y":53.01 },{ "x":61.23,"y":53.33 },{ "x":61.36,"y":53.66 },{ "x":61.62,"y":53.88 },{ "x":61.81,"y":54.25 },{ "x":61.99,"y":54.58 },{ "x":62.15,"y":54.85 },{ "x":62.3,"y":55.18 },{ "x":62.51,"y":55.39 },{ "x":62.7,"y":55.66 },{ "x":62.93,"y":55.88 },{ "x":63.14,"y":56.1 },{ "x":63.53,"y":56.26 },{ "x":64.14,"y":56.42 },{ "x":64.42,"y":56.53 },{ "x":64.71,"y":56.64 },{ "x":65.08,"y":56.75 },{ "x":65.45,"y":57.02 },{ "x":65.79,"y":57.07 },{ "x":66.1,"y":57.24 },{ "x":66.44,"y":57.29 },{ "x":66.73,"y":57.4 } ]
  },
  {
    "name": "بقعة دم قريبة من الحمام",
    "points": [ { "x":15.76,"y":68.08 },{ "x":15.73,"y":68.4 },{ "x":15.65,"y":68.78 },{ "x":15.6,"y":69.16 },{ "x":15.52,"y":69.49 },{ "x":15.47,"y":69.86 },{ "x":15.34,"y":70.3 },{ "x":15.24,"y":70.62 },{ "x":15.08,"y":70.95 },{ "x":14.79,"y":71.22 },{ "x":14.5,"y":71.33 },{ "x":14.16,"y":71.49 },{ "x":13.85,"y":71.54 },{ "x":13.8,"y":71.87 },{ "x":13.74,"y":72.2 },{ "x":13.74,"y":72.57 },{ "x":13.77,"y":72.95 },{ "x":13.87,"y":73.39 },{ "x":13.87,"y":73.77 },{ "x":13.82,"y":74.09 },{ "x":13.66,"y":74.53 },{ "x":13.56,"y":74.91 },{ "x":13.46,"y":75.23 },{ "x":13.46,"y":75.61 },{ "x":13.64,"y":76.04 },{ "x":13.87,"y":76.31 },{ "x":14.21,"y":76.37 },{ "x":14.55,"y":76.48 },{ "x":14.9,"y":76.48 },{ "x":15.24,"y":76.53 },{ "x":15.55,"y":76.53 },{ "x":15.84,"y":76.42 },{ "x":15.99,"y":76.1 },{ "x":16.18,"y":76.37 },{ "x":16.15,"y":76.69 },{ "x":16.13,"y":77.07 },{ "x":16.05,"y":77.45 },{ "x":15.97,"y":77.78 },{ "x":15.94,"y":78.1 },{ "x":16.18,"y":78.32 },{ "x":16.49,"y":78.16 },{ "x":16.73,"y":77.89 },{ "x":16.99,"y":77.67 },{ "x":17.28,"y":77.51 },{ "x":17.43,"y":77.24 },{ "x":17.59,"y":76.96 },{ "x":17.77,"y":76.59 },{ "x":17.91,"y":76.15 },{ "x":18.06,"y":75.88 },{ "x":17.98,"y":76.21 },{ "x":17.88,"y":76.53 },{ "x":17.67,"y":76.86 },{ "x":17.54,"y":77.13 },{ "x":17.36,"y":77.51 },{ "x":17.09,"y":77.94 },{ "x":16.96,"y":78.27 },{ "x":16.81,"y":78.59 },{ "x":16.62,"y":78.97 },{ "x":16.54,"y":79.35 },{ "x":16.62,"y":79.73 },{ "x":16.88,"y":80.11 },{ "x":17.12,"y":80.33 },{ "x":17.3,"y":80.6 },{ "x":17.67,"y":80.65 },{ "x":18.06,"y":80.65 },{ "x":18.43,"y":80.7 },{ "x":18.77,"y":80.81 },{ "x":19.11,"y":80.87 },{ "x":19.42,"y":80.98 },{ "x":19.84,"y":81.03 },{ "x":20.13,"y":81.3 },{ "x":20.39,"y":81.57 },{ "x":20.71,"y":81.79 },{ "x":20.99,"y":81.95 },{ "x":21.39,"y":82.11 },{ "x":21.86,"y":82.33 },{ "x":22.28,"y":82.6 },{ "x":22.64,"y":82.6 },{ "x":22.98,"y":82.6 },{ "x":23.25,"y":82.28 },{ "x":23.46,"y":82.01 },{ "x":23.77,"y":81.73 },{ "x":24.01,"y":81.41 },{ "x":24.24,"y":81.19 },{ "x":24.42,"y":80.92 },{ "x":24.63,"y":80.65 },{ "x":24.76,"y":80.38 },{ "x":24.9,"y":80.11 },{ "x":24.97,"y":79.78 },{ "x":24.97,"y":79.46 },{ "x":25.16,"y":79.08 },{ "x":25.5,"y":78.64 },{ "x":25.68,"y":78.37 },{ "x":25.92,"y":78.1 },{ "x":26.18,"y":77.83 },{ "x":26.41,"y":77.56 },{ "x":26.6,"y":77.29 },{ "x":26.62,"y":76.96 },{ "x":26.39,"y":76.75 },{ "x":26.1,"y":76.64 },{ "x":25.79,"y":76.59 },{ "x":25.5,"y":76.42 },{ "x":25.16,"y":76.37 },{ "x":24.79,"y":76.37 },{ "x":24.37,"y":76.37 },{ "x":24.03,"y":76.37 },{ "x":23.69,"y":76.37 },{ "x":23.35,"y":76.26 },{ "x":23.01,"y":76.1 },{ "x":22.75,"y":75.93 },{ "x":22.43,"y":75.88 },{ "x":22.17,"y":75.72 },{ "x":21.88,"y":75.56 },{ "x":21.73,"y":75.28 },{ "x":21.7,"y":74.96 },{ "x":21.94,"y":74.74 },{ "x":22.23,"y":74.58 },{ "x":22.57,"y":74.36 },{ "x":22.83,"y":74.2 },{ "x":23.14,"y":74.09 },{ "x":23.48,"y":74.09 },{ "x":23.82,"y":74.09 },{ "x":24.14,"y":74.09 },{ "x":24.45,"y":74.25 },{ "x":24.79,"y":74.36 },{ "x":25.03,"y":74.58 },{ "x":25.42,"y":74.85 },{ "x":25.86,"y":75.07 },{ "x":26.2,"y":75.28 },{ "x":26.49,"y":75.45 },{ "x":26.81,"y":75.56 },{ "x":27.17,"y":75.56 },{ "x":27.54,"y":75.56 },{ "x":27.88,"y":75.56 },{ "x":28.22,"y":75.56 },{ "x":28.53,"y":75.5 },{ "x":28.87,"y":75.45 },{ "x":29.19,"y":75.45 },{ "x":29.48,"y":75.34 },{ "x":29.63,"y":74.96 },{ "x":29.79,"y":74.69 },{ "x":29.97,"y":74.36 },{ "x":30.24,"y":74.04 },{ "x":30.45,"y":73.71 },{ "x":30.71,"y":73.5 },{ "x":30.89,"y":73.22 },{ "x":31.02,"y":72.9 },{ "x":31.13,"y":72.57 },{ "x":31.31,"y":72.25 },{ "x":31.41,"y":71.87 },{ "x":31.47,"y":71.49 },{ "x":31.47,"y":71.06 },{ "x":31.44,"y":70.73 },{ "x":31.23,"y":70.41 },{ "x":30.89,"y":70.41 },{ "x":30.5,"y":70.24 },{ "x":30.1,"y":70.14 },{ "x":29.76,"y":70.14 },{ "x":29.42,"y":70.08 },{ "x":29.14,"y":69.92 },{ "x":28.77,"y":69.76 },{ "x":28.46,"y":69.76 },{ "x":28.12,"y":69.7 },{ "x":27.72,"y":69.54 },{ "x":27.38,"y":69.38 },{ "x":27.07,"y":69.21 },{ "x":26.78,"y":69.11 },{ "x":26.39,"y":69.11 },{ "x":26.05,"y":69.21 },{ "x":25.79,"y":69.38 },{ "x":25.52,"y":69.54 },{ "x":25.29,"y":69.76 },{ "x":25,"y":69.86 },{ "x":24.87,"y":69.59 },{ "x":24.74,"y":69.27 },{ "x":24.74,"y":68.89 },{ "x":24.66,"y":68.51 },{ "x":24.61,"y":68.13 },{ "x":24.55,"y":67.8 },{ "x":24.48,"y":67.37 },{ "x":24.42,"y":67.05 },{ "x":24.32,"y":66.61 },{ "x":24.21,"y":66.29 },{ "x":24.11,"y":65.96 },{ "x":23.8,"y":65.91 },{ "x":23.46,"y":65.91 },{ "x":23.09,"y":66.07 },{ "x":22.7,"y":66.18 },{ "x":22.33,"y":66.18 },{ "x":21.88,"y":66.4 },{ "x":21.57,"y":66.4 },{ "x":21.44,"y":66.72 },{ "x":21.44,"y":67.1 },{ "x":21.44,"y":67.43 },{ "x":21.44,"y":67.86 },{ "x":21.52,"y":68.18 },{ "x":21.54,"y":68.56 },{ "x":21.62,"y":68.89 },{ "x":21.68,"y":69.27 },{ "x":21.68,"y":69.65 },{ "x":21.68,"y":69.97 },{ "x":21.68,"y":70.57 },{ "x":21.68,"y":70.89 },{ "x":21.68,"y":71.27 },{ "x":21.68,"y":71.6 },{ "x":21.68,"y":71.98 },{ "x":21.68,"y":72.36 },{ "x":21.65,"y":72.74 },{ "x":21.57,"y":73.06 },{ "x":21.47,"y":73.44 },{ "x":21.34,"y":73.82 },{ "x":21.02,"y":73.88 },{ "x":20.68,"y":73.88 },{ "x":20.37,"y":73.88 },{ "x":20.1,"y":73.66 },{ "x":19.95,"y":73.39 },{ "x":19.69,"y":73.12 },{ "x":19.53,"y":72.85 },{ "x":19.32,"y":72.63 },{ "x":19.08,"y":72.41 },{ "x":18.82,"y":72.25 },{ "x":18.56,"y":72.09 },{ "x":18.27,"y":71.76 },{ "x":18.04,"y":71.54 },{ "x":17.83,"y":71.22 },{ "x":17.67,"y":70.95 },{ "x":17.46,"y":70.68 },{ "x":17.3,"y":70.41 },{ "x":17.04,"y":70.19 },{ "x":16.81,"y":69.92 },{ "x":16.6,"y":69.7 },{ "x":16.34,"y":69.49 },{ "x":16.07,"y":69.32 },{ "x":15.92,"y":69 },{ "x":15.84,"y":68.62 } ]
  },
  {
    "name": "يد مقطوعة داخل المرحاض",
    "points": [ { "x":22.43,"y":57.62 },{ "x":22.15,"y":57.51 },{ "x":21.81,"y":57.34 },{ "x":21.49,"y":57.29 },{ "x":21.18,"y":57.29 },{ "x":20.89,"y":57.4 },{ "x":20.65,"y":57.62 },{ "x":20.55,"y":57.94 },{ "x":20.37,"y":58.21 },{ "x":20.37,"y":58.54 },{ "x":20.37,"y":58.92 },{ "x":20.42,"y":59.24 },{ "x":20.5,"y":59.57 },{ "x":20.68,"y":59.84 },{ "x":20.86,"y":60.16 },{ "x":21.13,"y":60.33 },{ "x":21.31,"y":60.6 },{ "x":21.65,"y":60.6 },{ "x":21.96,"y":60.6 },{ "x":22.23,"y":60.43 },{ "x":22.43,"y":60.22 },{ "x":22.49,"y":59.89 },{ "x":22.54,"y":59.51 },{ "x":22.57,"y":59.19 },{ "x":22.62,"y":58.81 },{ "x":22.62,"y":58.43 },{ "x":22.62,"y":58.05 },{ "x":22.62,"y":57.72 } ]
  },
  {
    "name": "جثة على الأرض",
    "points": [ { "x":68.14,"y":63.41 },{ "x":68.14,"y":63.79 },{ "x":68.14,"y":64.34 },{ "x":68.14,"y":64.77 },{ "x":68.14,"y":65.26 },{ "x":68.14,"y":65.58 },{ "x":68.14,"y":65.96 },{ "x":68.09,"y":66.29 },{ "x":68.09,"y":66.67 },{ "x":68.06,"y":67.05 },{ "x":68.01,"y":67.37 },{ "x":68.01,"y":67.75 },{ "x":67.96,"y":68.18 },{ "x":67.91,"y":68.51 },{ "x":67.91,"y":68.83 },{ "x":67.91,"y":69.21 },{ "x":67.91,"y":69.59 },{ "x":67.88,"y":69.92 },{ "x":67.88,"y":70.3 },{ "x":67.88,"y":70.68 },{ "x":68.4,"y":70.79 },{ "x":68.64,"y":71 },{ "x":69.19,"y":71.44 },{ "x":69.48,"y":71.54 },{ "x":69.74,"y":71.76 },{ "x":70.08,"y":71.76 },{ "x":70.45,"y":71.82 },{ "x":70.84,"y":71.92 },{ "x":71.2,"y":72.09 },{ "x":71.49,"y":72.25 },{ "x":71.81,"y":72.36 },{ "x":72.07,"y":72.52 },{ "x":72.36,"y":72.63 },{ "x":72.72,"y":72.79 },{ "x":73.17,"y":73.06 },{ "x":73.64,"y":73.17 },{ "x":74.14,"y":73.22 },{ "x":74.48,"y":73.39 },{ "x":74.79,"y":73.5 },{ "x":75.13,"y":73.55 },{ "x":75.39,"y":73.71 },{ "x":75.73,"y":73.71 },{ "x":76.07,"y":73.71 },{ "x":76.44,"y":73.82 },{ "x":76.99,"y":73.82 },{ "x":77.33,"y":73.82 },{ "x":77.75,"y":73.82 },{ "x":78.22,"y":73.82 },{ "x":78.59,"y":73.98 },{ "x":78.95,"y":74.04 },{ "x":79.29,"y":74.15 },{ "x":79.79,"y":74.31 },{ "x":80.1,"y":74.42 },{ "x":80.47,"y":74.69 },{ "x":80.86,"y":74.91 },{ "x":81.2,"y":75.01 },{ "x":81.57,"y":75.07 },{ "x":81.96,"y":75.18 },{ "x":82.38,"y":75.34 },{ "x":82.88,"y":75.56 },{ "x":83.22,"y":75.72 },{ "x":83.64,"y":75.72 },{ "x":83.95,"y":75.72 },{ "x":84.27,"y":75.77 },{ "x":84.55,"y":75.88 },{ "x":84.92,"y":76.04 },{ "x":85.26,"y":76.21 },{ "x":85.52,"y":76.37 },{ "x":85.86,"y":76.37 },{ "x":86.15,"y":76.48 },{ "x":86.49,"y":76.48 },{ "x":87.2,"y":76.48 },{ "x":87.64,"y":76.48 },{ "x":88.25,"y":76.48 },{ "x":88.59,"y":76.48 },{ "x":88.93,"y":76.48 },{ "x":89.03,"y":76.04 },{ "x":89.42,"y":76.04 },{ "x":89.69,"y":75.88 },{ "x":90.03,"y":75.77 },{ "x":90.37,"y":75.61 },{ "x":90.63,"y":75.39 },{ "x":90.92,"y":75.28 },{ "x":91.15,"y":75.01 },{ "x":91.52,"y":74.91 },{ "x":91.86,"y":74.91 },{ "x":92.2,"y":74.91 },{ "x":92.57,"y":74.91 },{ "x":92.91,"y":74.91 },{ "x":93.17,"y":74.63 },{ "x":93.32,"y":74.36 },{ "x":93.61,"y":74.09 },{ "x":93.77,"y":73.82 },{ "x":93.93,"y":73.55 },{ "x":94.03,"y":73.22 },{ "x":94.06,"y":72.74 },{ "x":94.06,"y":72.36 },{ "x":94.06,"y":71.98 },{ "x":94.06,"y":71.65 },{ "x":94.06,"y":71.22 },{ "x":94.06,"y":70.89 },{ "x":93.95,"y":70.46 },{ "x":93.87,"y":70.14 },{ "x":93.82,"y":69.81 },{ "x":93.69,"y":69.38 },{ "x":93.56,"y":69.05 },{ "x":93.38,"y":68.73 },{ "x":93.19,"y":68.46 },{ "x":93.01,"y":68.18 },{ "x":92.67,"y":68.08 },{ "x":92.41,"y":67.91 },{ "x":92.07,"y":67.64 },{ "x":91.75,"y":67.48 },{ "x":91.41,"y":67.43 },{ "x":91.15,"y":67.21 },{ "x":90.79,"y":67.1 },{ "x":90.45,"y":67.1 },{ "x":90.08,"y":67.1 },{ "x":89.79,"y":66.94 },{ "x":89.58,"y":66.72 },{ "x":89.29,"y":66.61 },{ "x":88.95,"y":66.5 },{ "x":88.66,"y":66.34 },{ "x":88.27,"y":66.23 },{ "x":87.93,"y":66.07 },{ "x":87.67,"y":65.85 },{ "x":87.17,"y":65.58 },{ "x":86.88,"y":65.42 },{ "x":86.54,"y":65.26 },{ "x":86.28,"y":64.99 },{ "x":86.05,"y":64.77 },{ "x":85.73,"y":64.44 },{ "x":85.39,"y":64.07 },{ "x":85.13,"y":63.74 },{ "x":84.92,"y":63.52 },{ "x":84.58,"y":63.52 },{ "x":84.27,"y":63.52 },{ "x":83.9,"y":63.58 },{ "x":83.64,"y":63.79 },{ "x":83.19,"y":63.79 },{ "x":82.88,"y":63.79 },{ "x":82.57,"y":63.74 },{ "x":82.28,"y":63.63 },{ "x":81.94,"y":63.63 },{ "x":81.62,"y":63.63 },{ "x":81.28,"y":63.63 },{ "x":80.86,"y":63.63 },{ "x":80.52,"y":63.63 },{ "x":80.08,"y":63.63 },{ "x":79.69,"y":63.63 },{ "x":79.35,"y":63.63 },{ "x":79.01,"y":63.63 },{ "x":78.69,"y":63.63 },{ "x":78.35,"y":63.63 },{ "x":77.98,"y":63.63 },{ "x":77.62,"y":63.36 },{ "x":77.23,"y":63.2 },{ "x":76.91,"y":63.14 },{ "x":76.62,"y":63.04 },{ "x":76.26,"y":63.04 },{ "x":75.94,"y":63.04 },{ "x":75.58,"y":63.04 },{ "x":75.26,"y":63.04 },{ "x":74.82,"y":63.04 },{ "x":74.42,"y":63.2 },{ "x":74.08,"y":63.2 },{ "x":73.74,"y":63.36 },{ "x":73.32,"y":63.36 },{ "x":72.98,"y":63.36 },{ "x":72.64,"y":63.36 },{ "x":72.3,"y":63.47 },{ "x":71.91,"y":63.47 },{ "x":71.54,"y":63.47 },{ "x":71.13,"y":63.47 },{ "x":70.84,"y":63.36 },{ "x":70.47,"y":63.2 },{ "x":70.18,"y":63.04 },{ "x":69.82,"y":62.98 },{ "x":69.5,"y":62.98 },{ "x":69.19,"y":62.98 },{ "x":68.87,"y":63.14 },{ "x":68.61,"y":63.31 } ]
  },

{
    "name": "بقعة دم على الحائط",
    "points": [
      {
        "x": 15.52,
        "y": 11.06
      },
      {
        "x": 15.29,
        "y": 11.54
      },
      {
        "x": 15.1,
        "y": 11.82
      },
      {
        "x": 14.92,
        "y": 12.25
      },
      {
        "x": 14.79,
        "y": 12.63
      },
      {
        "x": 14.5,
        "y": 13.55
      },
      {
        "x": 14.37,
        "y": 13.93
      },
      {
        "x": 14.21,
        "y": 14.42
      },
      {
        "x": 14.01,
        "y": 14.96
      },
      {
        "x": 13.9,
        "y": 15.39
      },
      {
        "x": 13.74,
        "y": 15.83
      },
      {
        "x": 13.69,
        "y": 16.15
      },
      {
        "x": 13.56,
        "y": 16.53
      },
      {
        "x": 13.46,
        "y": 16.91
      },
      {
        "x": 13.38,
        "y": 17.29
      },
      {
        "x": 13.3,
        "y": 17.78
      },
      {
        "x": 13.3,
        "y": 18.16
      },
      {
        "x": 13.3,
        "y": 18.54
      },
      {
        "x": 13.35,
        "y": 19.13
      },
      {
        "x": 13.43,
        "y": 19.51
      },
      {
        "x": 13.51,
        "y": 20
      },
      {
        "x": 13.59,
        "y": 20.49
      },
      {
        "x": 13.64,
        "y": 20.81
      },
      {
        "x": 13.66,
        "y": 21.41
      },
      {
        "x": 13.66,
        "y": 21.79
      },
      {
        "x": 13.61,
        "y": 22.33
      },
      {
        "x": 13.46,
        "y": 23.09
      },
      {
        "x": 13.43,
        "y": 23.58
      },
      {
        "x": 13.38,
        "y": 24.23
      },
      {
        "x": 13.38,
        "y": 24.61
      },
      {
        "x": 13.38,
        "y": 24.99
      },
      {
        "x": 13.38,
        "y": 25.85
      },
      {
        "x": 13.38,
        "y": 26.72
      },
      {
        "x": 13.32,
        "y": 27.26
      },
      {
        "x": 13.32,
        "y": 27.64
      },
      {
        "x": 13.32,
        "y": 28.13
      },
      {
        "x": 13.32,
        "y": 28.56
      },
      {
        "x": 13.32,
        "y": 28.89
      },
      {
        "x": 13.38,
        "y": 29.32
      },
      {
        "x": 13.38,
        "y": 29.65
      },
      {
        "x": 13.38,
        "y": 29.97
      },
      {
        "x": 13.46,
        "y": 30.35
      },
      {
        "x": 13.53,
        "y": 30.84
      },
      {
        "x": 13.56,
        "y": 31.22
      },
      {
        "x": 13.59,
        "y": 31.6
      },
      {
        "x": 13.59,
        "y": 32.2
      },
      {
        "x": 13.59,
        "y": 32.57
      },
      {
        "x": 13.59,
        "y": 32.9
      },
      {
        "x": 13.59,
        "y": 33.33
      },
      {
        "x": 13.59,
        "y": 33.66
      },
      {
        "x": 13.59,
        "y": 33.98
      },
      {
        "x": 13.59,
        "y": 34.36
      },
      {
        "x": 13.59,
        "y": 34.74
      },
      {
        "x": 13.59,
        "y": 35.18
      },
      {
        "x": 13.59,
        "y": 35.5
      },
      {
        "x": 13.64,
        "y": 35.83
      },
      {
        "x": 13.72,
        "y": 36.21
      },
      {
        "x": 13.82,
        "y": 36.53
      },
      {
        "x": 13.98,
        "y": 36.8
      },
      {
        "x": 14.11,
        "y": 37.13
      },
      {
        "x": 14.35,
        "y": 37.34
      },
      {
        "x": 14.53,
        "y": 37.02
      },
      {
        "x": 14.53,
        "y": 36.64
      },
      {
        "x": 14.42,
        "y": 36.21
      },
      {
        "x": 14.4,
        "y": 35.88
      },
      {
        "x": 14.37,
        "y": 35.45
      },
      {
        "x": 14.37,
        "y": 35.12
      },
      {
        "x": 14.37,
        "y": 34.8
      },
      {
        "x": 14.37,
        "y": 34.42
      },
      {
        "x": 14.37,
        "y": 34.04
      },
      {
        "x": 14.42,
        "y": 33.55
      },
      {
        "x": 14.45,
        "y": 33.17
      },
      {
        "x": 14.5,
        "y": 32.85
      },
      {
        "x": 14.71,
        "y": 32.63
      },
      {
        "x": 15.05,
        "y": 32.47
      },
      {
        "x": 15.42,
        "y": 32.3
      },
      {
        "x": 15.71,
        "y": 32.09
      },
      {
        "x": 16.15,
        "y": 31.98
      },
      {
        "x": 16.7,
        "y": 31.98
      },
      {
        "x": 17.02,
        "y": 32.03
      },
      {
        "x": 17.46,
        "y": 32.14
      },
      {
        "x": 17.72,
        "y": 32.3
      },
      {
        "x": 18.06,
        "y": 32.47
      },
      {
        "x": 18.27,
        "y": 32.74
      },
      {
        "x": 18.53,
        "y": 32.95
      },
      {
        "x": 18.82,
        "y": 33.28
      },
      {
        "x": 18.95,
        "y": 33.6
      },
      {
        "x": 19.19,
        "y": 33.82
      },
      {
        "x": 19.4,
        "y": 34.15
      },
      {
        "x": 19.55,
        "y": 34.42
      },
      {
        "x": 19.74,
        "y": 34.69
      },
      {
        "x": 19.9,
        "y": 34.96
      },
      {
        "x": 20.08,
        "y": 35.28
      },
      {
        "x": 20.26,
        "y": 35.61
      },
      {
        "x": 20.42,
        "y": 35.99
      },
      {
        "x": 20.45,
        "y": 36.37
      },
      {
        "x": 20.5,
        "y": 36.69
      },
      {
        "x": 20.5,
        "y": 37.07
      },
      {
        "x": 20.5,
        "y": 37.45
      },
      {
        "x": 20.5,
        "y": 37.83
      },
      {
        "x": 20.5,
        "y": 38.16
      },
      {
        "x": 20.5,
        "y": 38.54
      },
      {
        "x": 20.52,
        "y": 38.92
      },
      {
        "x": 20.79,
        "y": 39.19
      },
      {
        "x": 21.05,
        "y": 39.46
      },
      {
        "x": 21.54,
        "y": 39.62
      },
      {
        "x": 21.86,
        "y": 39.78
      },
      {
        "x": 22.15,
        "y": 39.89
      },
      {
        "x": 22.51,
        "y": 39.95
      },
      {
        "x": 22.83,
        "y": 39.95
      },
      {
        "x": 23.19,
        "y": 39.95
      },
      {
        "x": 23.51,
        "y": 39.95
      },
      {
        "x": 23.8,
        "y": 39.67
      },
      {
        "x": 23.95,
        "y": 39.3
      },
      {
        "x": 24.06,
        "y": 38.92
      },
      {
        "x": 24.08,
        "y": 38.54
      },
      {
        "x": 24.14,
        "y": 38.21
      },
      {
        "x": 24.16,
        "y": 37.83
      },
      {
        "x": 24.16,
        "y": 37.45
      },
      {
        "x": 24.16,
        "y": 37.13
      },
      {
        "x": 24.16,
        "y": 36.75
      },
      {
        "x": 24.16,
        "y": 36.37
      },
      {
        "x": 24.16,
        "y": 36.04
      },
      {
        "x": 24.11,
        "y": 35.66
      },
      {
        "x": 24.03,
        "y": 35.12
      },
      {
        "x": 23.95,
        "y": 34.63
      },
      {
        "x": 23.9,
        "y": 34.25
      },
      {
        "x": 23.85,
        "y": 33.93
      },
      {
        "x": 23.77,
        "y": 33.5
      },
      {
        "x": 23.74,
        "y": 33.17
      },
      {
        "x": 23.69,
        "y": 32.85
      },
      {
        "x": 23.66,
        "y": 32.52
      },
      {
        "x": 23.61,
        "y": 32.14
      },
      {
        "x": 23.56,
        "y": 31.82
      },
      {
        "x": 23.48,
        "y": 31.38
      },
      {
        "x": 23.38,
        "y": 31
      },
      {
        "x": 23.3,
        "y": 30.35
      },
      {
        "x": 23.27,
        "y": 29.97
      },
      {
        "x": 23.22,
        "y": 29.59
      },
      {
        "x": 23.19,
        "y": 29.21
      },
      {
        "x": 23.12,
        "y": 28.73
      },
      {
        "x": 23.04,
        "y": 28.29
      },
      {
        "x": 22.98,
        "y": 27.86
      },
      {
        "x": 22.96,
        "y": 27.48
      },
      {
        "x": 22.96,
        "y": 27.15
      },
      {
        "x": 22.96,
        "y": 26.78
      },
      {
        "x": 23.3,
        "y": 26.07
      },
      {
        "x": 23.53,
        "y": 25.53
      },
      {
        "x": 23.72,
        "y": 25.26
      },
      {
        "x": 23.85,
        "y": 24.93
      },
      {
        "x": 23.87,
        "y": 24.61
      },
      {
        "x": 23.98,
        "y": 24.28
      },
      {
        "x": 24.03,
        "y": 23.85
      },
      {
        "x": 24.03,
        "y": 23.52
      },
      {
        "x": 23.87,
        "y": 23.25
      },
      {
        "x": 23.61,
        "y": 22.98
      },
      {
        "x": 23.38,
        "y": 22.76
      },
      {
        "x": 22.98,
        "y": 22.55
      },
      {
        "x": 22.67,
        "y": 22.22
      },
      {
        "x": 22.49,
        "y": 21.95
      },
      {
        "x": 22.36,
        "y": 21.63
      },
      {
        "x": 22.23,
        "y": 21.3
      },
      {
        "x": 22.15,
        "y": 20.81
      },
      {
        "x": 22.09,
        "y": 20.43
      },
      {
        "x": 22.09,
        "y": 20
      },
      {
        "x": 22.12,
        "y": 19.67
      },
      {
        "x": 22.2,
        "y": 19.02
      },
      {
        "x": 22.36,
        "y": 18.64
      },
      {
        "x": 22.43,
        "y": 18.27
      },
      {
        "x": 22.57,
        "y": 17.83
      },
      {
        "x": 22.67,
        "y": 17.45
      },
      {
        "x": 22.8,
        "y": 17.18
      },
      {
        "x": 22.91,
        "y": 16.8
      },
      {
        "x": 23.01,
        "y": 16.31
      },
      {
        "x": 23.01,
        "y": 15.99
      },
      {
        "x": 23.06,
        "y": 15.61
      },
      {
        "x": 23.06,
        "y": 15.28
      },
      {
        "x": 23.06,
        "y": 14.96
      },
      {
        "x": 23.04,
        "y": 14.53
      },
      {
        "x": 22.77,
        "y": 14.25
      },
      {
        "x": 22.59,
        "y": 13.98
      },
      {
        "x": 22.25,
        "y": 13.71
      },
      {
        "x": 21.86,
        "y": 13.77
      },
      {
        "x": 21.68,
        "y": 14.15
      },
      {
        "x": 21.68,
        "y": 14.69
      },
      {
        "x": 21.68,
        "y": 15.28
      },
      {
        "x": 21.68,
        "y": 15.83
      },
      {
        "x": 21.65,
        "y": 16.26
      },
      {
        "x": 21.57,
        "y": 16.59
      },
      {
        "x": 21.54,
        "y": 16.91
      },
      {
        "x": 21.23,
        "y": 17.13
      },
      {
        "x": 21.1,
        "y": 16.86
      },
      {
        "x": 20.86,
        "y": 16.64
      },
      {
        "x": 20.76,
        "y": 16.31
      },
      {
        "x": 20.68,
        "y": 15.93
      },
      {
        "x": 20.6,
        "y": 15.39
      },
      {
        "x": 20.6,
        "y": 15.01
      },
      {
        "x": 20.6,
        "y": 14.69
      },
      {
        "x": 20.6,
        "y": 14.31
      },
      {
        "x": 20.52,
        "y": 13.98
      },
      {
        "x": 20.45,
        "y": 13.6
      },
      {
        "x": 20.45,
        "y": 13.28
      },
      {
        "x": 20.37,
        "y": 12.9
      },
      {
        "x": 20.08,
        "y": 12.68
      },
      {
        "x": 19.82,
        "y": 12.2
      },
      {
        "x": 19.58,
        "y": 11.82
      },
      {
        "x": 19.29,
        "y": 11.44
      },
      {
        "x": 19.11,
        "y": 11.11
      },
      {
        "x": 18.87,
        "y": 10.89
      },
      {
        "x": 18.64,
        "y": 10.57
      },
      {
        "x": 18.25,
        "y": 10.41
      },
      {
        "x": 17.98,
        "y": 10.19
      },
      {
        "x": 17.7,
        "y": 10.08
      },
      {
        "x": 17.57,
        "y": 10.41
      },
      {
        "x": 17.43,
        "y": 10.79
      },
      {
        "x": 17.36,
        "y": 11.17
      },
      {
        "x": 17.23,
        "y": 11.6
      },
      {
        "x": 17.15,
        "y": 11.98
      },
      {
        "x": 17.04,
        "y": 12.41
      },
      {
        "x": 16.91,
        "y": 12.68
      },
      {
        "x": 16.83,
        "y": 13.01
      },
      {
        "x": 16.7,
        "y": 13.33
      },
      {
        "x": 16.57,
        "y": 13.6
      },
      {
        "x": 16.44,
        "y": 13.88
      },
      {
        "x": 16.15,
        "y": 13.6
      },
      {
        "x": 15.94,
        "y": 13.28
      },
      {
        "x": 15.81,
        "y": 12.9
      },
      {
        "x": 15.65,
        "y": 12.41
      },
      {
        "x": 15.58,
        "y": 12.03
      },
      {
        "x": 15.55,
        "y": 11.6
      },
      {
        "x": 15.5,
        "y": 11.27
      },
      {
        "x": 15.5,
        "y": 10.89
      },
      {
        "x": 15.47,
        "y": 10.57
      },
      {
        "x": 15.47,
        "y": 10.24
      }
    ]
  }
]; // end shapes

/* prepare shapes state */
shapes.forEach(s => { s.found = false; });

/* render invisible polygons into overlay (viewBox 0..100) */
function renderPolygons(){
  overlay.innerHTML = ''; // clear
  shapes.forEach((s, idx) => {
    const poly = document.createElementNS('http://www.w3.org/2000/svg','polygon');
    // join points into "x,y x,y ..." (percent coords)
    const pts = s.points.map(p => (p.x.toFixed(4) + ',' + p.y.toFixed(4))).join(' ');
    poly.setAttribute('points', pts);
    // invisible but active
    poly.setAttribute('fill', '#ff0000');
    poly.setAttribute('fill-opacity', '0'); // hidden
    poly.setAttribute('stroke', 'none');
    poly.setAttribute('data-index', idx);
    poly.style.cursor = 'pointer';
    // pointer events are needed for fallback; we will still use our own hit test
    poly.style.pointerEvents = 'auto';
    overlay.appendChild(poly);
  });
}

/* geometry helpers: point-in-polygon (ray-casting) */
function pointInPoly(x,y, polyPts){
  // polyPts: [{x:,y:}, ...] in percentage space (0..100)
  let inside = false;
  for(let i=0,j=polyPts.length-1;i<polyPts.length;j=i++){
    const xi = polyPts[i].x, yi = polyPts[i].y;
    const xj = polyPts[j].x, yj = polyPts[j].y;
    const intersect = ((yi>y)!=(yj>y)) && (x < (xj-xi)*(y-yi)/(yj-yi+0.0000001)+xi);
    if(intersect) inside = !inside;
  }
  return inside;
}

/* distance from point to segment (in percentage units) */
function distPointToSeg(px,py, x1,y1, x2,y2){
  const A = px - x1, B = py - y1, C = x2 - x1, D = y2 - y1;
  const dot = A*C + B*D;
  const len_sq = C*C + D*D;
  let param = -1;
  if(len_sq !== 0) param = dot / len_sq;
  let xx, yy;
  if(param < 0){ xx = x1; yy = y1; }
  else if(param > 1){ xx = x2; yy = y2; }
  else { xx = x1 + param * C; yy = y1 + param * D; }
  const dx = px - xx, dy = py - yy;
  return Math.hypot(dx, dy);
}

/* convert client point to percent coordinates relative to image bounding box */
function clientToPercent(clientX, clientY){
  const r = bg.getBoundingClientRect();
  const x = (clientX - r.left) / r.width * 100;
  const y = (clientY - r.top) / r.height * 100;
  return { x, y };
}

/* show tooltip near centroid (in client pixels) */
function showTooltipAtCentroid(s){
  // compute centroid in percent
  const pts = s.points;
  let sx=0, sy=0;
  pts.forEach(p=>{ sx+=p.x; sy+=p.y; });
  const cx = sx/pts.length, cy = sy/pts.length;
  const r = bg.getBoundingClientRect();

  // 🔹 نحسب الإحداثيات ونحرك التولتيب إلى اليسار بدل اليمين
  tooltip.textContent = s.name;
  tooltip.style.display = 'block';
  const left = r.left + (cx/100)*r.width - tooltip.offsetWidth - 8;
  const top  = r.top  + (cy/100)*r.height - 10;
  tooltip.style.left = left + 'px';
  tooltip.style.top  = top + 'px';

  clearTimeout(showTooltipAtCentroid._t);
  showTooltipAtCentroid._t = setTimeout(()=> tooltip.style.display='none', 3000);
}


/* show toast */
function showToast(txt){
  toast.textContent = txt;
  toast.style.display = 'block';
  clearTimeout(showToast._t);
  showToast._t = setTimeout(()=> toast.style.display='none', 1600);
}

/* speech helpers (same voice as before) */
function speak(txt){
  try{ const s=window.speechSynthesis, u=new SpeechSynthesisUtterance(txt); u.lang='ar-SA'; u.rate=.95; s.cancel(); s.speak(u); }catch(e){}
}
function speakAwait(txt){
  return new Promise(res=>{ try{ const s=window.speechSynthesis, u=new SpeechSynthesisUtterance(txt); u.lang='ar-SA'; u.rate=.95; u.onend=()=>res(); s.cancel(); s.speak(u); }catch(e){ res(); } });
}

/* ===== Loader progress ===== */
function simulateProgress(ms){
  const t0 = performance.now();
  (function tick(){
    const k = Math.min(1,(performance.now()-t0)/ms);
    bar.style.width = (k*100).toFixed(1)+'%';
    if(k<1) requestAnimationFrame(tick);
    else setTimeout(afterLoading, 200);
  })();
}

function afterLoading(){
  loader.classList.add('fade-hide');
  setTimeout(()=> loader.style.display='none', 650);
  intro.classList.add('show');
  speakAwait("عزيزي الطالب الضابط، بعد الانتهاء من معاينة مسرح الجريمة الثلاثي الأبعاد، الآن جاء الوقت لاختبارك بتحديد الأدلة الموجودة في مسرح الجريمة. اضغط ابدأ جمع الأدلة.").then(()=>{
    startBtn.classList.add('show');
  });
}

/* preloads image then start progress */
window.addEventListener('load', async ()=>{
  await preloadImage(bg.src);
  renderPolygons(); // populate overlay
  simulateProgress(3000);
});
function preloadImage(url){ return new Promise((res,rej)=>{ const i=new Image(); i.onload=()=>res(); i.onerror=rej; i.src=url; }); }

/* ===== Start button transitions ===== */
startBtn.addEventListener('click', ()=>{
  intro.classList.add('fade-hide');
  setTimeout(()=>{ intro.style.display='none'; scene.classList.add('show'); requestAnimationFrame(()=> scene.classList.add('visible')); startCountdown(); enableInvestigation(); }, 600);
});

/* ===== Timer ===== */
function startCountdown(){
  renderTimer();
  timerHandle = setInterval(()=>{ countdown--; renderTimer(); if(countdown<=0){ clearInterval(timerHandle); speak("انتهى الوقت، حاول مجددًا."); showEnd(false); } }, 1000);
}
function renderTimer(){
  const m = String(Math.floor(countdown/60)).padStart(2,'0');
  const s = String(countdown%60).padStart(2,'0');
  timerEl.textContent = `الوقت المتبقي: ${m}:${s}`;
  timerEl.classList.toggle('warning', countdown<=10);
}

/* ===== Investigation logic ===== */
function enableInvestigation(){
  // click on sceneWrap
  document.getElementById('sceneWrap').addEventListener('pointerdown', onScenePointer, {passive:true});
}

function onScenePointer(e){
  const clientX = e.clientX, clientY = e.clientY;
  const pt = clientToPercent(clientX, clientY);
  let hitIndex = -1;
  let minDist = Infinity;

  shapes.forEach((s, idx) => {
    if(s.found) return;
    // direct inside?
    if(pointInPoly(pt.x, pt.y, s.points)){
      hitIndex = idx; minDist = 0;
      return;
    }
    // else compute minimum distance to polygon edges (in percent units)
    for(let i=0,j=s.points.length-1;i<s.points.length;j=i++){
      const d = distPointToSeg(pt.x, pt.y, s.points[j].x, s.points[j].y, s.points[i].x, s.points[i].y);
      if(d < minDist){ minDist = d; hitIndex = idx; }
    }
  });

  // threshold: treat as hit if inside or distance <= thresholdPercent
  // choose threshold percent so that on a typical viewport it approximates ~20px. We'll compute pixel-based threshold:
  const r = bg.getBoundingClientRect();
  const pxThreshold = 20; // desired ~20px
  const percentThresholdX = pxThreshold / r.width * 100;
  const percentThresholdY = pxThreshold / r.height * 100;
  // we use smaller of the two to be stricter
  const percentThreshold = Math.min(percentThresholdX, percentThresholdY);

  // determine if we actually hit the chosen closest shape
  let didHit = false;
  if(hitIndex >=0){
    const s = shapes[hitIndex];
    if(pointInPoly(pt.x, pt.y, s.points)) didHit = true;
    else {
      // compute min distance to this polygon edges accurately
      let md = Infinity;
      for(let i=0,j=s.points.length-1;i<s.points.length;j=i++){
        const d = distPointToSeg(pt.x, pt.y, s.points[j].x, s.points[j].y, s.points[i].x, s.points[i].y);
        if(d < md) md = d;
      }
      if(md <= percentThreshold) didHit = true;
    }
  }

  if(didHit && hitIndex>=0){
    handleCorrectShape(hitIndex);
  } else {
    showToast("لا يوجد دليل هنا، ابحث في مكان آخر.");
    speak("لا يوجد دليل هنا، ابحث في مكان آخر.");
  }
}

function handleCorrectShape(idx){
  const s = shapes[idx];
  if(s.found) return;
  s.found = true;
  foundCount++;

  // أظهر التلميح الصوتي والنصي
  showTooltipAtCentroid(s);
  speak("فعلاً هذا دليل مادي صحيح: " + s.name);

  // احسب مركز الشكل
  const r = bg.getBoundingClientRect();
  const pts = s.points;
  let sx = 0, sy = 0;
  pts.forEach(p => { sx += p.x; sy += p.y; });
  const cx = sx / pts.length, cy = sy / pts.length;
  const left = r.left + (cx / 100) * r.width;
  const top  = r.top  + (cy / 100) * r.height;

  // أنشئ علامة ✅ ثابتة فوق الدليل
  const mark = document.createElement('div');
  mark.textContent = "✅";
  mark.style.position = 'fixed';
  mark.style.left = (left - 12) + 'px';
  mark.style.top  = (top - 28) + 'px';
  mark.style.fontSize = '24px';
  mark.style.color = '#00ff66';
  mark.style.textShadow = '0 0 10px rgba(0,255,0,.8)';
  mark.style.zIndex = 150;
  document.body.appendChild(mark);

  if(foundCount === shapes.length){
    clearInterval(timerHandle);
    speak("أحسنت أيها الطالب الضابط، لقد حددت جميع الأدلة بنجاح!");
    setTimeout(()=> showEnd(true), 900);
  }
}


/* ===== End modal handling ===== */
function showEnd(success = true) {
  const title = document.getElementById("endTitle");
  const text = document.getElementById("endText");
  title.textContent = success ? "🎉 تم تحديد جميع الأدلة بنجاح" : "⏳ انتهى الوقت";
  text.textContent = success
    ? "أحسنت يا ضابط، لقد حددت جميع الأدلة بنجاح!"
    : "بعض الأدلة لم تُحدد. بإمكانك إعادة المهمة أو الانتقال للمرحلة التالية.";
  endModal.style.display = "flex";

  // 🔹 التحويل التلقائي للمرحلة التالية بعد 5 ثوانٍ في حال النجاح فقط
  if (success) {
    setTimeout(() => {
      window.location.href = "https://dns3uae-glitch.github.io/crime-book/3d-2/";
    }, 5000);
  }
}


/* Accessibility: Enter starts */
document.addEventListener('keydown', (e)=>{ if(e.key==='Enter' && startBtn.classList.contains('show')) startBtn.click(); });

/* resize observer to keep overlay aligned: we use viewBox 0..100 -> percent coords map directly,
   so no additional repaint needed for polygon coordinates. But we keep overlay size synced in CSS. */



/* sanity: renderPolygons already called on load */

/* End of script */
// ===== Loader simulation =====
let loadProgress = 0;
function simulateLoading() {
  loadProgress += 5;
  bar.style.width = loadProgress + "%";
  if (loadProgress >= 100) {
    setTimeout(() => {
      loader.style.display = "none";
      intro.classList.add("show");
      setTimeout(() => startBtn.classList.add("show"), 1000);
    }, 500);
  } else {
    setTimeout(simulateLoading, 150);
  }
}
window.addEventListener("load", simulateLoading);

</script>
</body>
</html>


